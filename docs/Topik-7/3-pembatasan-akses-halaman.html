<!DOCTYPE html>
<html>
<head>
<title>3-pembatasan-akses-halaman.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="pembatasan-akses-halaman-di-laravel">Pembatasan Akses Halaman di Laravel</h1>
<p>Setelah mengimplementasikan sistem autentikasi dasar, kita perlu membuat pembatasan akses agar pengguna hanya dapat mengakses halaman sesuai dengan hak akses mereka. Tutorial ini akan menjelaskan cara membatasi akses halaman secara efektif dalam aplikasi Laravel mahasiswa.</p>
<h2 id="1-persiapan-struktur-pengguna-dengan-peran-role">1. Persiapan Struktur Pengguna dengan Peran (Role)</h2>
<p>Pertama, kita perlu menambahkan kolom role ke tabel users:</p>
<pre class="hljs"><code><div>php artisan make:migration add_role_to_users_table --table=users
</div></code></pre>
<p>Edit file migrasi yang baru dibuat:</p>
<pre class="hljs"><code><div><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
</span>{
    Schema::table(<span class="hljs-string">'users'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(Blueprint $table)</span> </span>{
        $table-&gt;enum(<span class="hljs-string">'role'</span>, [<span class="hljs-string">'admin'</span>, <span class="hljs-string">'dosen'</span>, <span class="hljs-string">'mahasiswa'</span>])-&gt;default(<span class="hljs-string">'mahasiswa'</span>);
    });
}

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>
</span>{
    Schema::table(<span class="hljs-string">'users'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(Blueprint $table)</span> </span>{
        $table-&gt;dropColumn(<span class="hljs-string">'role'</span>);
    });
}
</div></code></pre>
<p>Jalankan migrasi:</p>
<pre class="hljs"><code><div>php artisan migrate
</div></code></pre>
<p>Tambahkan kolom role ke model User:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// app/Models/User.php</span>
<span class="hljs-keyword">protected</span> $fillable = [
    <span class="hljs-string">'name'</span>,
    <span class="hljs-string">'email'</span>,
    <span class="hljs-string">'password'</span>,
    <span class="hljs-string">'role'</span>, <span class="hljs-comment">// Tambahkan role ke fillable</span>
];
</div></code></pre>
<h2 id="2-membuat-middleware-untuk-pembatasan-akses-berdasarkan-role">2. Membuat Middleware untuk Pembatasan Akses Berdasarkan Role</h2>
<pre class="hljs"><code><div>php artisan make:middleware CheckRole
</div></code></pre>
<p>Edit file middleware yang baru dibuat:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// app/Http/Middleware/CheckRole.php</span>
<span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Middleware</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Closure</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Request</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CheckRole</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span><span class="hljs-params">(Request $request, Closure $next, ...$roles)</span>
    </span>{
        <span class="hljs-comment">// Pastikan user sudah login</span>
        <span class="hljs-keyword">if</span> (!$request-&gt;user()) {
            <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">'login'</span>);
        }

        <span class="hljs-comment">// Cek apakah user memiliki role yang diizinkan</span>
        <span class="hljs-keyword">if</span> (in_array($request-&gt;user()-&gt;role, $roles)) {
            <span class="hljs-keyword">return</span> $next($request);
        }

        <span class="hljs-comment">// Jika tidak memiliki akses, redirect dengan pesan</span>
        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">'dashboard'</span>)-&gt;with(<span class="hljs-string">'error'</span>, <span class="hljs-string">'Anda tidak memiliki izin untuk mengakses halaman ini.'</span>);
    }
}
</div></code></pre>
<p>Daftarkan middleware di Kernel:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// app/Http/Kernel.php</span>
<span class="hljs-keyword">protected</span> $routeMiddleware = [
    <span class="hljs-comment">// Middleware lain...</span>
    <span class="hljs-string">'role'</span> =&gt; \App\Http\Middleware\CheckRole::class,
];
</div></code></pre>
<h2 id="3-menerapkan-pembatasan-akses-pada-route">3. Menerapkan Pembatasan Akses pada Route</h2>
<p>Sekarang kita bisa menerapkan middleware role pada route:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// routes/web.php</span>

<span class="hljs-comment">// Halaman yang bisa diakses semua user yang sudah login</span>
Route::middleware([<span class="hljs-string">'auth'</span>])-&gt;group(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    Route::get(<span class="hljs-string">'/dashboard'</span>, [DashboardController::class, <span class="hljs-string">'index'</span>])-&gt;name(<span class="hljs-string">'dashboard'</span>);
    Route::get(<span class="hljs-string">'/profile'</span>, [ProfileController::class, <span class="hljs-string">'index'</span>])-&gt;name(<span class="hljs-string">'profile'</span>);
});

<span class="hljs-comment">// Halaman khusus Admin</span>
Route::middleware([<span class="hljs-string">'auth'</span>, <span class="hljs-string">'role:admin'</span>])-&gt;group(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    Route::get(<span class="hljs-string">'/admin/users'</span>, [AdminController::class, <span class="hljs-string">'users'</span>])-&gt;name(<span class="hljs-string">'admin.users'</span>);
    Route::get(<span class="hljs-string">'/admin/settings'</span>, [AdminController::class, <span class="hljs-string">'settings'</span>])-&gt;name(<span class="hljs-string">'admin.settings'</span>);
});

<span class="hljs-comment">// Halaman untuk Admin dan Dosen</span>
Route::middleware([<span class="hljs-string">'auth'</span>, <span class="hljs-string">'role:admin,dosen'</span>])-&gt;group(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    Route::resource(<span class="hljs-string">'nilai'</span>, NilaiController::class);
});

<span class="hljs-comment">// Halaman untuk Mahasiswa</span>
Route::middleware([<span class="hljs-string">'auth'</span>, <span class="hljs-string">'role:mahasiswa'</span>])-&gt;group(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    Route::get(<span class="hljs-string">'/krs'</span>, [KrsController::class, <span class="hljs-string">'index'</span>])-&gt;name(<span class="hljs-string">'krs.index'</span>);
});
</div></code></pre>
<h2 id="4-menerapkan-pembatasan-akses-pada-controller">4. Menerapkan Pembatasan Akses pada Controller</h2>
<p>Alternatif lain, kita bisa menerapkan middleware di constructor controller:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// app/Http/Controllers/AdminController.php</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">$this</span>-&gt;middleware(<span class="hljs-string">'auth'</span>);
    <span class="hljs-keyword">$this</span>-&gt;middleware(<span class="hljs-string">'role:admin'</span>);
}
</div></code></pre>
<h2 id="5-menerapkan-pembatasan-akses-pada-blade-views">5. Menerapkan Pembatasan Akses pada Blade Views</h2>
<p>Kita juga perlu menyembunyikan tombol atau link yang tidak seharusnya diakses oleh user:</p>
<pre class="hljs"><code><div>&lt;!-- resources/views/layouts/app.blade.php --&gt;
&lt;nav&gt;
    @auth
        &lt;a href=<span class="hljs-string">"{{ route('dashboard') }}"</span>&gt;Dashboard&lt;/a&gt;
        &lt;a href=<span class="hljs-string">"{{ route('profile') }}"</span>&gt;Profile&lt;/a&gt;
        
        @<span class="hljs-keyword">if</span>(auth()-&gt;user()-&gt;role === <span class="hljs-string">'admin'</span>)
            &lt;a href=<span class="hljs-string">"{{ route('admin.users') }}"</span>&gt;Manage Users&lt;/a&gt;
            &lt;a href=<span class="hljs-string">"{{ route('admin.settings') }}"</span>&gt;Settings&lt;/a&gt;
        @<span class="hljs-keyword">endif</span>
        
        @<span class="hljs-keyword">if</span>(in_array(auth()-&gt;user()-&gt;role, [<span class="hljs-string">'admin'</span>, <span class="hljs-string">'dosen'</span>]))
            &lt;a href=<span class="hljs-string">"{{ route('nilai.index') }}"</span>&gt;Nilai Mahasiswa&lt;/a&gt;
        @<span class="hljs-keyword">endif</span>
        
        @<span class="hljs-keyword">if</span>(auth()-&gt;user()-&gt;role === <span class="hljs-string">'mahasiswa'</span>)
            &lt;a href=<span class="hljs-string">"{{ route('krs.index') }}"</span>&gt;KRS&lt;/a&gt;
        @<span class="hljs-keyword">endif</span>
    @endauth
&lt;/nav&gt;
</div></code></pre>
<h2 id="6-membuat-blade-directive-kustom-untuk-mempermudah-pembatasan-tampilan">6. Membuat Blade Directive Kustom untuk Mempermudah Pembatasan Tampilan</h2>
<p>Tambahkan directive kustom di AppServiceProvider:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// app/Providers/AppServiceProvider.php</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">boot</span><span class="hljs-params">()</span>
</span>{
    Blade::if(<span class="hljs-string">'role'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($roles)</span> </span>{
        <span class="hljs-keyword">return</span> auth()-&gt;check() &amp;&amp; (is_array($roles) 
            ? in_array(auth()-&gt;user()-&gt;role, $roles) 
            : auth()-&gt;user()-&gt;role === $roles);
    });
}
</div></code></pre>
<p>Kemudian gunakan directive ini di view:</p>
<pre class="hljs"><code><div>@role(<span class="hljs-string">'admin'</span>)
    &lt;a href=<span class="hljs-string">"{{ route('admin.users') }}"</span>&gt;Manage Users&lt;/a&gt;
@endrole

@role([<span class="hljs-string">'admin'</span>, <span class="hljs-string">'dosen'</span>])
    &lt;a href=<span class="hljs-string">"{{ route('nilai.index') }}"</span>&gt;Nilai Mahasiswa&lt;/a&gt;
@endrole
</div></code></pre>
<h2 id="7-menangani-pengecualian-izin-akses">7. Menangani Pengecualian Izin Akses</h2>
<p>Buat halaman error 403 kustom:</p>
<pre class="hljs"><code><div>php artisan vendor:publish --tag=laravel-errors
</div></code></pre>
<p>Edit file <code>resources/views/errors/403.blade.php</code>:</p>
<pre class="hljs"><code><div>@extends(<span class="hljs-string">'layouts.app'</span>)

@section(<span class="hljs-string">'content'</span>)
&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>="<span class="hljs-title">container</span>"&gt;
    &lt;<span class="hljs-title">div</span> <span class="hljs-title">class</span>="<span class="hljs-title">alert</span> <span class="hljs-title">alert</span>-<span class="hljs-title">danger</span>"&gt;
        &lt;<span class="hljs-title">h4</span>&gt;<span class="hljs-title">Akses</span> <span class="hljs-title">Ditolak</span>&lt;/<span class="hljs-title">h4</span>&gt;
        &lt;<span class="hljs-title">p</span>&gt;<span class="hljs-title">Anda</span> <span class="hljs-title">tidak</span> <span class="hljs-title">memiliki</span> <span class="hljs-title">izin</span> <span class="hljs-title">untuk</span> <span class="hljs-title">mengakses</span> <span class="hljs-title">halaman</span> <span class="hljs-title">ini</span>.&lt;/<span class="hljs-title">p</span>&gt;
        &lt;<span class="hljs-title">a</span> <span class="hljs-title">href</span>="</span>{{ route(<span class="hljs-string">'dashboard'</span>) }}<span class="hljs-string">" class="</span>btn btn-primary<span class="hljs-string">"&gt;Kembali ke Dashboard&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;
@endsection
</span></div></code></pre>
<p>Ubah handler di <code>app/Exceptions/Handler.php</code> untuk menangani AuthorizationException:</p>
<pre class="hljs"><code><div><span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Auth</span>\<span class="hljs-title">Access</span>\<span class="hljs-title">AuthorizationException</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">$this</span>-&gt;renderable(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(AuthorizationException $e, $request)</span> </span>{
        <span class="hljs-keyword">return</span> response()-&gt;view(<span class="hljs-string">'errors.403'</span>, [], <span class="hljs-number">403</span>);
    });
}
</div></code></pre>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TD
    A[User mengakses URL] --> B{User sudah login?}
    B -->|Tidak| C[Redirect ke halaman login]
    B -->|Ya| D{Cek role user}
    
    D -->|Admin| E[Akses semua halaman]
    D -->|Dosen| F[Akses halaman dosen & umum]
    D -->|Mahasiswa| G[Akses halaman mahasiswa & umum]
    
    E --> H[Render halaman yang diminta]
    F --> H
    G --> H
    
    D -->|Role tidak punya akses| I[Tampilkan error 403]
    I --> J[Redirect ke dashboard]
    
    C --> K[Proses login]
    K --> B

</div></code></pre>
<h2 id="diagram-proses-pembatasan-akses">Diagram Proses Pembatasan Akses</h2>
<pre><code class="language-mermaid"><div class="mermaid">sequenceDiagram
    participant User
    participant Router
    participant AuthMiddleware
    participant RoleMiddleware
    participant Controller
    participant View
    
    User->>Router: Request halaman
    Router->>AuthMiddleware: Cek autentikasi
    
    alt User belum login
        AuthMiddleware-->>User: Redirect ke login
    else User sudah login
        AuthMiddleware->>RoleMiddleware: Cek role user
        
        alt Role tidak sesuai
            RoleMiddleware-->>User: Error 403 / Redirect
        else Role sesuai
            RoleMiddleware->>Controller: Lanjutkan request
            Controller->>View: Render view
            View->>User: Tampilkan view dengan menu sesuai role
        end
    end

</div></code></pre>
<h2 id="tips-pembatasan-akses-halaman">Tips Pembatasan Akses Halaman</h2>
<ol>
<li><strong>Gunakan Gates dan Policies</strong> untuk pembatasan akses yang lebih kompleks:</li>
</ol>
<pre class="hljs"><code><div><span class="hljs-comment">// Di AuthServiceProvider</span>
Gate::define(<span class="hljs-string">'manage-users'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($user)</span> </span>{
    <span class="hljs-keyword">return</span> $user-&gt;role === <span class="hljs-string">'admin'</span>;
});

<span class="hljs-comment">// Di controller atau middleware</span>
<span class="hljs-keyword">if</span> (Gate::allows(<span class="hljs-string">'manage-users'</span>)) {
    <span class="hljs-comment">// Lakukan aksi</span>
}

<span class="hljs-comment">// Di blade</span>
@can(<span class="hljs-string">'manage-users'</span>)
    &lt;a href=<span class="hljs-string">"{{ route('admin.users') }}"</span>&gt;Manage Users&lt;/a&gt;
@endcan
</div></code></pre>
<ol start="2">
<li><strong>Kombinasikan dengan fitur lain</strong> seperti email verification:</li>
</ol>
<pre class="hljs"><code><div>Route::middleware([<span class="hljs-string">'auth'</span>, <span class="hljs-string">'verified'</span>, <span class="hljs-string">'role:admin'</span>])-&gt;group(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// Route yang hanya bisa diakses admin yang sudah verifikasi email</span>
});
</div></code></pre>
<ol start="3">
<li><strong>Gunakan cache</strong> untuk menyimpan informasi role jika aplikasi memiliki banyak pengguna:</li>
</ol>
<pre class="hljs"><code><div><span class="hljs-comment">// Contoh caching role</span>
$userRole = Cache::remember(<span class="hljs-string">'user_role_'</span> . auth()-&gt;id(), <span class="hljs-number">60</span>*<span class="hljs-number">24</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> auth()-&gt;user()-&gt;role;
});
</div></code></pre>
<p>Dengan mengimplementasikan langkah-langkah di atas, aplikasi Laravel Anda akan memiliki sistem pembatasan akses yang efektif dan aman, sehingga setiap pengguna hanya dapat mengakses halaman sesuai dengan peran dan hak aksesnya.</p>

</body>
</html>
